# pipeline to build image via packer
trigger:
  branches:
    include:
    - feature/*
    - features/*
    - fix/*
#- main


pool:
  vmImage: ubuntu-latest

steps:
- task: AzureCLI@2
  displayName: Packer Build
  inputs:
    azureSubscription: 'Azure service connection'
    scriptType: bash
    scriptLocation: inlineScript
    inlineScript: |
      packer build ubuntu.json -var 'client_id=foo' -var 'client_secret=bar' -var 'tenant_id=baz' -var 'subscription_id=gipple'

# stages:
# - stage: Build
#   jobs:
#   - job: Packer_Build
#     pool: 
#       name: Default
#     steps:
#     - task: AzureCLI@2
#       displayName: Packer Build
#       inputs:
#         azureSubscription: 'Azure service connection'
#         scriptType: bash
#         scriptLocation: inlineScript
#         inlineScript: |
#           packer build ubuntu.json
